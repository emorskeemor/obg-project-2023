{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { h, ref, isRef, computed, watch, provide, onBeforeUnmount, getCurrentInstance } from 'vue';\nimport QBtn from '../btn/QBtn.js';\nimport QIcon from '../icon/QIcon.js';\nimport QSpinner from '../spinner/QSpinner.js';\nimport QCircularProgress from '../circular-progress/QCircularProgress.js';\nimport useDark, { useDarkProps } from '../../composables/private/use-dark.js';\nimport useFile, { useFileProps, useFileEmits } from '../../composables/private/use-file.js';\nimport { stop } from '../../utils/event.js';\nimport { humanStorageSize } from '../../utils/format.js';\nimport { uploaderKey } from '../../utils/private/symbols.js';\nimport { injectProp, injectMultipleProps } from '../../utils/private/inject-obj-prop.js';\n\nfunction getProgressLabel(p) {\n  return (p * 100).toFixed(2) + '%';\n}\n\nexport const coreProps = { ...useDarkProps,\n  ...useFileProps,\n  label: String,\n  color: String,\n  textColor: String,\n  square: Boolean,\n  flat: Boolean,\n  bordered: Boolean,\n  noThumbnails: Boolean,\n  autoUpload: Boolean,\n  hideUploadBtn: Boolean,\n  disable: Boolean,\n  readonly: Boolean\n};\nexport const coreEmits = [...useFileEmits, 'start', 'finish', 'added', 'removed'];\nexport function getRenderer(getPlugin) {\n  const vm = getCurrentInstance();\n  const {\n    props,\n    slots,\n    emit,\n    proxy\n  } = vm;\n  const {\n    $q\n  } = proxy;\n  const isDark = useDark(props, $q);\n\n  function updateFileStatus(file, status, uploadedSize) {\n    file.__status = status;\n\n    if (status === 'idle') {\n      file.__uploaded = 0;\n      file.__progress = 0;\n      file.__sizeLabel = humanStorageSize(file.size);\n      file.__progressLabel = '0.00%';\n      return;\n    }\n\n    if (status === 'failed') {\n      proxy.$forceUpdate();\n      return;\n    }\n\n    file.__uploaded = status === 'uploaded' ? file.size : uploadedSize;\n    file.__progress = status === 'uploaded' ? 1 : Math.min(0.9999, file.__uploaded / file.size);\n    file.__progressLabel = getProgressLabel(file.__progress);\n    proxy.$forceUpdate();\n  }\n\n  const editable = computed(() => props.disable !== true && props.readonly !== true);\n  const dnd = ref(false);\n  const rootRef = ref(null);\n  const inputRef = ref(null);\n  const state = {\n    files: ref([]),\n    queuedFiles: ref([]),\n    uploadedFiles: ref([]),\n    uploadedSize: ref(0),\n    updateFileStatus,\n\n    isAlive() {\n      return vm.isDeactivated !== true && vm.isUnmounted !== true;\n    }\n\n  };\n  const {\n    pickFiles,\n    addFiles,\n    onDragover,\n    onDragleave,\n    processFiles,\n    getDndNode,\n    maxFilesNumber,\n    maxTotalSizeNumber\n  } = useFile({\n    editable,\n    dnd,\n    getFileInput,\n    addFilesToQueue\n  });\n  Object.assign(state, getPlugin({\n    props,\n    slots,\n    emit,\n    helpers: state\n  }));\n\n  if (state.isBusy === void 0) {\n    state.isBusy = ref(false);\n  }\n\n  const uploadSize = ref(0);\n  const uploadProgress = computed(() => uploadSize.value === 0 ? 0 : state.uploadedSize.value / uploadSize.value);\n  const uploadProgressLabel = computed(() => getProgressLabel(uploadProgress.value));\n  const uploadSizeLabel = computed(() => humanStorageSize(uploadSize.value));\n  const canAddFiles = computed(() => editable.value === true && state.isUploading.value !== true // if single selection and no files are queued:\n  && (props.multiple === true || state.queuedFiles.value.length === 0) // if max-files is set and current number of files does not exceeds it:\n  && (props.maxFiles === void 0 || state.files.value.length < maxFilesNumber.value) // if max-total-size is set and current upload size does not exceeds it:\n  && (props.maxTotalSize === void 0 || uploadSize.value < maxTotalSizeNumber.value));\n  const canUpload = computed(() => editable.value === true && state.isBusy.value !== true && state.isUploading.value !== true && state.queuedFiles.value.length > 0);\n  provide(uploaderKey, renderInput);\n  const classes = computed(() => 'q-uploader column no-wrap' + (isDark.value === true ? ' q-uploader--dark q-dark' : '') + (props.bordered === true ? ' q-uploader--bordered' : '') + (props.square === true ? ' q-uploader--square no-border-radius' : '') + (props.flat === true ? ' q-uploader--flat no-shadow' : '') + (props.disable === true ? ' disabled q-uploader--disable' : '') + (dnd.value === true ? ' q-uploader--dnd' : ''));\n  const colorClass = computed(() => 'q-uploader__header' + (props.color !== void 0 ? ` bg-${props.color}` : '') + (props.textColor !== void 0 ? ` text-${props.textColor}` : ''));\n  watch(state.isUploading, (newVal, oldVal) => {\n    if (oldVal === false && newVal === true) {\n      emit('start');\n    } else if (oldVal === true && newVal === false) {\n      emit('finish');\n    }\n  });\n\n  function reset() {\n    if (props.disable === false) {\n      state.abort();\n      state.uploadedSize.value = 0;\n      uploadSize.value = 0;\n      revokeImgURLs();\n      state.files.value = [];\n      state.queuedFiles.value = [];\n      state.uploadedFiles.value = [];\n    }\n  }\n\n  function removeUploadedFiles() {\n    if (props.disable === false) {\n      batchRemoveFiles(['uploaded'], () => {\n        state.uploadedFiles.value = [];\n      });\n    }\n  }\n\n  function removeQueuedFiles() {\n    batchRemoveFiles(['idle', 'failed'], ({\n      size\n    }) => {\n      uploadSize.value -= size;\n      state.queuedFiles.value = [];\n    });\n  }\n\n  function batchRemoveFiles(statusList, cb) {\n    if (props.disable === true) {\n      return;\n    }\n\n    const removed = {\n      files: [],\n      size: 0\n    };\n    const localFiles = state.files.value.filter(f => {\n      if (statusList.indexOf(f.__status) === -1) {\n        return true;\n      }\n\n      removed.size += f.size;\n      removed.files.push(f);\n      f.__img !== void 0 && window.URL.revokeObjectURL(f.__img.src);\n      return false;\n    });\n\n    if (removed.files.length > 0) {\n      state.files.value = localFiles;\n      cb(removed);\n      emit('removed', removed.files);\n    }\n  }\n\n  function removeFile(file) {\n    if (props.disable) {\n      return;\n    }\n\n    if (file.__status === 'uploaded') {\n      state.uploadedFiles.value = state.uploadedFiles.value.filter(f => f.__key !== file.__key);\n    } else if (file.__status === 'uploading') {\n      file.__abort();\n    } else {\n      uploadSize.value -= file.size;\n    }\n\n    state.files.value = state.files.value.filter(f => {\n      if (f.__key !== file.__key) {\n        return true;\n      }\n\n      f.__img !== void 0 && window.URL.revokeObjectURL(f.__img.src);\n      return false;\n    });\n    state.queuedFiles.value = state.queuedFiles.value.filter(f => f.__key !== file.__key);\n    emit('removed', [file]);\n  }\n\n  function revokeImgURLs() {\n    state.files.value.forEach(f => {\n      f.__img !== void 0 && window.URL.revokeObjectURL(f.__img.src);\n    });\n  }\n\n  function getFileInput() {\n    return inputRef.value || rootRef.value.getElementsByClassName('q-uploader__input')[0];\n  }\n\n  function addFilesToQueue(e, fileList) {\n    const localFiles = processFiles(e, fileList, state.files.value, true);\n    const fileInput = getFileInput();\n\n    if (fileInput !== void 0 && fileInput !== null) {\n      fileInput.value = '';\n    }\n\n    if (localFiles === void 0) {\n      return;\n    }\n\n    localFiles.forEach(file => {\n      state.updateFileStatus(file, 'idle');\n      uploadSize.value += file.size;\n\n      if (props.noThumbnails !== true && file.type.toUpperCase().startsWith('IMAGE')) {\n        const img = new Image();\n        img.src = window.URL.createObjectURL(file);\n        file.__img = img;\n      }\n    });\n    state.files.value = state.files.value.concat(localFiles);\n    state.queuedFiles.value = state.queuedFiles.value.concat(localFiles);\n    emit('added', localFiles);\n    props.autoUpload === true && state.upload();\n  }\n\n  function upload() {\n    canUpload.value === true && state.upload();\n  }\n\n  function getBtn(show, icon, fn) {\n    if (show === true) {\n      const data = {\n        type: 'a',\n        key: icon,\n        icon: $q.iconSet.uploader[icon],\n        flat: true,\n        dense: true\n      };\n      let child = void 0;\n\n      if (icon === 'add') {\n        data.onClick = pickFiles;\n        child = renderInput;\n      } else {\n        data.onClick = fn;\n      }\n\n      return h(QBtn, data, child);\n    }\n  }\n\n  function renderInput() {\n    return h('input', {\n      ref: inputRef,\n      class: 'q-uploader__input overflow-hidden absolute-full',\n      tabindex: -1,\n      type: 'file',\n      title: '',\n      // try to remove default tooltip\n      accept: props.accept,\n      multiple: props.multiple === true ? 'multiple' : void 0,\n      capture: props.capture,\n      onMousedown: stop,\n      // need to stop refocus from QBtn\n      onClick: pickFiles,\n      onChange: addFilesToQueue\n    });\n  }\n\n  function getHeader() {\n    if (slots.header !== void 0) {\n      return slots.header(publicApi);\n    }\n\n    return [h('div', {\n      class: 'q-uploader__header-content column'\n    }, [h('div', {\n      class: 'flex flex-center no-wrap q-gutter-xs'\n    }, [getBtn(state.queuedFiles.value.length > 0, 'removeQueue', removeQueuedFiles), getBtn(state.uploadedFiles.value.length > 0, 'removeUploaded', removeUploadedFiles), state.isUploading.value === true ? h(QSpinner, {\n      class: 'q-uploader__spinner'\n    }) : null, h('div', {\n      class: 'col column justify-center'\n    }, [props.label !== void 0 ? h('div', {\n      class: 'q-uploader__title'\n    }, [props.label]) : null, h('div', {\n      class: 'q-uploader__subtitle'\n    }, [uploadSizeLabel.value + ' / ' + uploadProgressLabel.value])]), getBtn(canAddFiles.value, 'add'), getBtn(props.hideUploadBtn === false && canUpload.value === true, 'upload', state.upload), getBtn(state.isUploading.value, 'clear', state.abort)])])];\n  }\n\n  function getList() {\n    if (slots.list !== void 0) {\n      return slots.list(publicApi);\n    }\n\n    return state.files.value.map(file => h('div', {\n      key: file.__key,\n      class: 'q-uploader__file relative-position' + (props.noThumbnails !== true && file.__img !== void 0 ? ' q-uploader__file--img' : '') + (file.__status === 'failed' ? ' q-uploader__file--failed' : file.__status === 'uploaded' ? ' q-uploader__file--uploaded' : ''),\n      style: props.noThumbnails !== true && file.__img !== void 0 ? {\n        backgroundImage: 'url(\"' + file.__img.src + '\")'\n      } : null\n    }, [h('div', {\n      class: 'q-uploader__file-header row flex-center no-wrap'\n    }, [file.__status === 'failed' ? h(QIcon, {\n      class: 'q-uploader__file-status',\n      name: $q.iconSet.type.negative,\n      color: 'negative'\n    }) : null, h('div', {\n      class: 'q-uploader__file-header-content col'\n    }, [h('div', {\n      class: 'q-uploader__title'\n    }, [file.name]), h('div', {\n      class: 'q-uploader__subtitle row items-center no-wrap'\n    }, [file.__sizeLabel + ' / ' + file.__progressLabel])]), file.__status === 'uploading' ? h(QCircularProgress, {\n      value: file.__progress,\n      min: 0,\n      max: 1,\n      indeterminate: file.__progress === 0\n    }) : h(QBtn, {\n      round: true,\n      dense: true,\n      flat: true,\n      icon: $q.iconSet.uploader[file.__status === 'uploaded' ? 'done' : 'clear'],\n      onClick: () => {\n        removeFile(file);\n      }\n    })])]));\n  }\n\n  onBeforeUnmount(() => {\n    state.isUploading.value === true && state.abort();\n    state.files.value.length > 0 && revokeImgURLs();\n  });\n  const publicApi = {};\n\n  for (const key in state) {\n    if (isRef(state[key]) === true) {\n      injectProp(publicApi, key, () => state[key].value);\n    } else {\n      // method or non-computed prop\n      publicApi[key] = state[key];\n    }\n  }\n\n  Object.assign(publicApi, {\n    upload,\n    reset,\n    removeUploadedFiles,\n    removeQueuedFiles,\n    removeFile,\n    pickFiles,\n    addFiles\n  });\n  injectMultipleProps(publicApi, {\n    canAddFiles: () => canAddFiles.value,\n    canUpload: () => canUpload.value,\n    uploadSizeLabel: () => uploadSizeLabel.value,\n    uploadProgressLabel: () => uploadProgressLabel.value\n  }); // expose public api (methods & computed props)\n\n  Object.assign(proxy, publicApi);\n  return () => {\n    const children = [h('div', {\n      class: colorClass.value\n    }, getHeader()), h('div', {\n      class: 'q-uploader__list scroll'\n    }, getList()), getDndNode('uploader')];\n    state.isBusy.value === true && children.push(h('div', {\n      class: 'q-uploader__overlay absolute-full flex flex-center'\n    }, [h(QSpinner)]));\n    const data = {\n      ref: rootRef,\n      class: classes.value\n    };\n\n    if (canAddFiles.value === true) {\n      Object.assign(data, {\n        onDragover,\n        onDragleave\n      });\n    }\n\n    return h('div', data, children);\n  };\n}","map":{"version":3,"names":["h","ref","isRef","computed","watch","provide","onBeforeUnmount","getCurrentInstance","QBtn","QIcon","QSpinner","QCircularProgress","useDark","useDarkProps","useFile","useFileProps","useFileEmits","stop","humanStorageSize","uploaderKey","injectProp","injectMultipleProps","getProgressLabel","p","toFixed","coreProps","label","String","color","textColor","square","Boolean","flat","bordered","noThumbnails","autoUpload","hideUploadBtn","disable","readonly","coreEmits","getRenderer","getPlugin","vm","props","slots","emit","proxy","$q","isDark","updateFileStatus","file","status","uploadedSize","__status","__uploaded","__progress","__sizeLabel","size","__progressLabel","$forceUpdate","Math","min","editable","dnd","rootRef","inputRef","state","files","queuedFiles","uploadedFiles","isAlive","isDeactivated","isUnmounted","pickFiles","addFiles","onDragover","onDragleave","processFiles","getDndNode","maxFilesNumber","maxTotalSizeNumber","getFileInput","addFilesToQueue","Object","assign","helpers","isBusy","uploadSize","uploadProgress","value","uploadProgressLabel","uploadSizeLabel","canAddFiles","isUploading","multiple","length","maxFiles","maxTotalSize","canUpload","renderInput","classes","colorClass","newVal","oldVal","reset","abort","revokeImgURLs","removeUploadedFiles","batchRemoveFiles","removeQueuedFiles","statusList","cb","removed","localFiles","filter","f","indexOf","push","__img","window","URL","revokeObjectURL","src","removeFile","__key","__abort","forEach","getElementsByClassName","e","fileList","fileInput","type","toUpperCase","startsWith","img","Image","createObjectURL","concat","upload","getBtn","show","icon","fn","data","key","iconSet","uploader","dense","child","onClick","class","tabindex","title","accept","capture","onMousedown","onChange","getHeader","header","publicApi","getList","list","map","style","backgroundImage","name","negative","max","indeterminate","round","children"],"sources":["C:/Users/User/Documents/Projects/Option blocks/website/client/node_modules/quasar/src/components/uploader/uploader-core.js"],"sourcesContent":["import { h, ref, isRef, computed, watch, provide, onBeforeUnmount, getCurrentInstance } from 'vue'\n\nimport QBtn from '../btn/QBtn.js'\nimport QIcon from '../icon/QIcon.js'\nimport QSpinner from '../spinner/QSpinner.js'\nimport QCircularProgress from '../circular-progress/QCircularProgress.js'\n\nimport useDark, { useDarkProps } from '../../composables/private/use-dark.js'\nimport useFile, { useFileProps, useFileEmits } from '../../composables/private/use-file.js'\n\nimport { stop } from '../../utils/event.js'\nimport { humanStorageSize } from '../../utils/format.js'\nimport { uploaderKey } from '../../utils/private/symbols.js'\nimport { injectProp, injectMultipleProps } from '../../utils/private/inject-obj-prop.js'\n\nfunction getProgressLabel (p) {\n  return (p * 100).toFixed(2) + '%'\n}\n\nexport const coreProps = {\n  ...useDarkProps,\n  ...useFileProps,\n\n  label: String,\n\n  color: String,\n  textColor: String,\n\n  square: Boolean,\n  flat: Boolean,\n  bordered: Boolean,\n\n  noThumbnails: Boolean,\n  autoUpload: Boolean,\n  hideUploadBtn: Boolean,\n\n  disable: Boolean,\n  readonly: Boolean\n}\n\nexport const coreEmits = [\n  ...useFileEmits,\n  'start', 'finish', 'added', 'removed'\n]\n\nexport function getRenderer (getPlugin) {\n  const vm = getCurrentInstance()\n  const { props, slots, emit, proxy } = vm\n  const { $q } = proxy\n\n  const isDark = useDark(props, $q)\n\n  function updateFileStatus (file, status, uploadedSize) {\n    file.__status = status\n\n    if (status === 'idle') {\n      file.__uploaded = 0\n      file.__progress = 0\n      file.__sizeLabel = humanStorageSize(file.size)\n      file.__progressLabel = '0.00%'\n      return\n    }\n    if (status === 'failed') {\n      proxy.$forceUpdate()\n      return\n    }\n\n    file.__uploaded = status === 'uploaded'\n      ? file.size\n      : uploadedSize\n\n    file.__progress = status === 'uploaded'\n      ? 1\n      : Math.min(0.9999, file.__uploaded / file.size)\n\n    file.__progressLabel = getProgressLabel(file.__progress)\n    proxy.$forceUpdate()\n  }\n\n  const editable = computed(() => props.disable !== true && props.readonly !== true)\n  const dnd = ref(false)\n\n  const rootRef = ref(null)\n  const inputRef = ref(null)\n\n  const state = {\n    files: ref([]),\n    queuedFiles: ref([]),\n    uploadedFiles: ref([]),\n    uploadedSize: ref(0),\n\n    updateFileStatus,\n    isAlive () {\n      return vm.isDeactivated !== true && vm.isUnmounted !== true\n    }\n  }\n\n  const {\n    pickFiles,\n    addFiles,\n    onDragover,\n    onDragleave,\n    processFiles,\n    getDndNode,\n    maxFilesNumber,\n    maxTotalSizeNumber\n  } = useFile({ editable, dnd, getFileInput, addFilesToQueue })\n\n  Object.assign(state, getPlugin({ props, slots, emit, helpers: state }))\n\n  if (state.isBusy === void 0) {\n    state.isBusy = ref(false)\n  }\n\n  const uploadSize = ref(0)\n  const uploadProgress = computed(() => (\n    uploadSize.value === 0\n      ? 0\n      : state.uploadedSize.value / uploadSize.value\n  ))\n  const uploadProgressLabel = computed(() => getProgressLabel(uploadProgress.value))\n  const uploadSizeLabel = computed(() => humanStorageSize(uploadSize.value))\n\n  const canAddFiles = computed(() =>\n    editable.value === true\n    && state.isUploading.value !== true\n    // if single selection and no files are queued:\n    && (props.multiple === true || state.queuedFiles.value.length === 0)\n    // if max-files is set and current number of files does not exceeds it:\n    && (props.maxFiles === void 0 || state.files.value.length < maxFilesNumber.value)\n    // if max-total-size is set and current upload size does not exceeds it:\n    && (props.maxTotalSize === void 0 || uploadSize.value < maxTotalSizeNumber.value)\n  )\n\n  const canUpload = computed(() =>\n    editable.value === true\n    && state.isBusy.value !== true\n    && state.isUploading.value !== true\n    && state.queuedFiles.value.length > 0\n  )\n\n  provide(uploaderKey, renderInput)\n\n  const classes = computed(() =>\n    'q-uploader column no-wrap'\n    + (isDark.value === true ? ' q-uploader--dark q-dark' : '')\n    + (props.bordered === true ? ' q-uploader--bordered' : '')\n    + (props.square === true ? ' q-uploader--square no-border-radius' : '')\n    + (props.flat === true ? ' q-uploader--flat no-shadow' : '')\n    + (props.disable === true ? ' disabled q-uploader--disable' : '')\n    + (dnd.value === true ? ' q-uploader--dnd' : '')\n  )\n\n  const colorClass = computed(() =>\n    'q-uploader__header'\n    + (props.color !== void 0 ? ` bg-${ props.color }` : '')\n    + (props.textColor !== void 0 ? ` text-${ props.textColor }` : '')\n  )\n\n  watch(state.isUploading, (newVal, oldVal) => {\n    if (oldVal === false && newVal === true) {\n      emit('start')\n    }\n    else if (oldVal === true && newVal === false) {\n      emit('finish')\n    }\n  })\n\n  function reset () {\n    if (props.disable === false) {\n      state.abort()\n      state.uploadedSize.value = 0\n      uploadSize.value = 0\n      revokeImgURLs()\n      state.files.value = []\n      state.queuedFiles.value = []\n      state.uploadedFiles.value = []\n    }\n  }\n\n  function removeUploadedFiles () {\n    if (props.disable === false) {\n      batchRemoveFiles([ 'uploaded' ], () => {\n        state.uploadedFiles.value = []\n      })\n    }\n  }\n\n  function removeQueuedFiles () {\n    batchRemoveFiles([ 'idle', 'failed' ], ({ size }) => {\n      uploadSize.value -= size\n      state.queuedFiles.value = []\n    })\n  }\n\n  function batchRemoveFiles (statusList, cb) {\n    if (props.disable === true) {\n      return\n    }\n\n    const removed = {\n      files: [],\n      size: 0\n    }\n\n    const localFiles = state.files.value.filter(f => {\n      if (statusList.indexOf(f.__status) === -1) {\n        return true\n      }\n\n      removed.size += f.size\n      removed.files.push(f)\n\n      f.__img !== void 0 && window.URL.revokeObjectURL(f.__img.src)\n\n      return false\n    })\n\n    if (removed.files.length > 0) {\n      state.files.value = localFiles\n      cb(removed)\n      emit('removed', removed.files)\n    }\n  }\n\n  function removeFile (file) {\n    if (props.disable) { return }\n\n    if (file.__status === 'uploaded') {\n      state.uploadedFiles.value = state.uploadedFiles.value.filter(f => f.__key !== file.__key)\n    }\n    else if (file.__status === 'uploading') {\n      file.__abort()\n    }\n    else {\n      uploadSize.value -= file.size\n    }\n\n    state.files.value = state.files.value.filter(f => {\n      if (f.__key !== file.__key) {\n        return true\n      }\n\n      f.__img !== void 0 && window.URL.revokeObjectURL(f.__img.src)\n\n      return false\n    })\n\n    state.queuedFiles.value = state.queuedFiles.value.filter(f => f.__key !== file.__key)\n    emit('removed', [ file ])\n  }\n\n  function revokeImgURLs () {\n    state.files.value.forEach(f => {\n      f.__img !== void 0 && window.URL.revokeObjectURL(f.__img.src)\n    })\n  }\n\n  function getFileInput () {\n    return inputRef.value\n      || rootRef.value.getElementsByClassName('q-uploader__input')[ 0 ]\n  }\n\n  function addFilesToQueue (e, fileList) {\n    const localFiles = processFiles(e, fileList, state.files.value, true)\n    const fileInput = getFileInput()\n\n    if (fileInput !== void 0 && fileInput !== null) {\n      fileInput.value = ''\n    }\n\n    if (localFiles === void 0) { return }\n\n    localFiles.forEach(file => {\n      state.updateFileStatus(file, 'idle')\n      uploadSize.value += file.size\n\n      if (props.noThumbnails !== true && file.type.toUpperCase().startsWith('IMAGE')) {\n        const img = new Image()\n        img.src = window.URL.createObjectURL(file)\n        file.__img = img\n      }\n    })\n\n    state.files.value = state.files.value.concat(localFiles)\n    state.queuedFiles.value = state.queuedFiles.value.concat(localFiles)\n    emit('added', localFiles)\n    props.autoUpload === true && state.upload()\n  }\n\n  function upload () {\n    canUpload.value === true && state.upload()\n  }\n\n  function getBtn (show, icon, fn) {\n    if (show === true) {\n      const data = {\n        type: 'a',\n        key: icon,\n        icon: $q.iconSet.uploader[ icon ],\n        flat: true,\n        dense: true\n      }\n\n      let child = void 0\n\n      if (icon === 'add') {\n        data.onClick = pickFiles\n        child = renderInput\n      }\n      else {\n        data.onClick = fn\n      }\n\n      return h(QBtn, data, child)\n    }\n  }\n\n  function renderInput () {\n    return h('input', {\n      ref: inputRef,\n      class: 'q-uploader__input overflow-hidden absolute-full',\n      tabindex: -1,\n      type: 'file',\n      title: '', // try to remove default tooltip\n      accept: props.accept,\n      multiple: props.multiple === true ? 'multiple' : void 0,\n      capture: props.capture,\n      onMousedown: stop, // need to stop refocus from QBtn\n      onClick: pickFiles,\n      onChange: addFilesToQueue\n    })\n  }\n\n  function getHeader () {\n    if (slots.header !== void 0) {\n      return slots.header(publicApi)\n    }\n\n    return [\n      h('div', {\n        class: 'q-uploader__header-content column'\n      }, [\n        h('div', {\n          class: 'flex flex-center no-wrap q-gutter-xs'\n        }, [\n          getBtn(state.queuedFiles.value.length > 0, 'removeQueue', removeQueuedFiles),\n          getBtn(state.uploadedFiles.value.length > 0, 'removeUploaded', removeUploadedFiles),\n\n          state.isUploading.value === true\n            ? h(QSpinner, { class: 'q-uploader__spinner' })\n            : null,\n\n          h('div', { class: 'col column justify-center' }, [\n            props.label !== void 0\n              ? h('div', { class: 'q-uploader__title' }, [ props.label ])\n              : null,\n\n            h('div', { class: 'q-uploader__subtitle' }, [\n              uploadSizeLabel.value + ' / ' + uploadProgressLabel.value\n            ])\n          ]),\n\n          getBtn(canAddFiles.value, 'add'),\n          getBtn(props.hideUploadBtn === false && canUpload.value === true, 'upload', state.upload),\n          getBtn(state.isUploading.value, 'clear', state.abort)\n        ])\n      ])\n    ]\n  }\n\n  function getList () {\n    if (slots.list !== void 0) {\n      return slots.list(publicApi)\n    }\n\n    return state.files.value.map(file => h('div', {\n      key: file.__key,\n      class: 'q-uploader__file relative-position'\n        + (props.noThumbnails !== true && file.__img !== void 0 ? ' q-uploader__file--img' : '')\n        + (\n          file.__status === 'failed'\n            ? ' q-uploader__file--failed'\n            : (file.__status === 'uploaded' ? ' q-uploader__file--uploaded' : '')\n        ),\n      style: props.noThumbnails !== true && file.__img !== void 0\n        ? { backgroundImage: 'url(\"' + file.__img.src + '\")' }\n        : null\n    }, [\n      h('div', {\n        class: 'q-uploader__file-header row flex-center no-wrap'\n      }, [\n        file.__status === 'failed'\n          ? h(QIcon, {\n            class: 'q-uploader__file-status',\n            name: $q.iconSet.type.negative,\n            color: 'negative'\n          })\n          : null,\n\n        h('div', { class: 'q-uploader__file-header-content col' }, [\n          h('div', { class: 'q-uploader__title' }, [ file.name ]),\n          h('div', {\n            class: 'q-uploader__subtitle row items-center no-wrap'\n          }, [\n            file.__sizeLabel + ' / ' + file.__progressLabel\n          ])\n        ]),\n\n        file.__status === 'uploading'\n          ? h(QCircularProgress, {\n            value: file.__progress,\n            min: 0,\n            max: 1,\n            indeterminate: file.__progress === 0\n          })\n          : h(QBtn, {\n            round: true,\n            dense: true,\n            flat: true,\n            icon: $q.iconSet.uploader[ file.__status === 'uploaded' ? 'done' : 'clear' ],\n            onClick: () => { removeFile(file) }\n          })\n      ])\n    ]))\n  }\n\n  onBeforeUnmount(() => {\n    state.isUploading.value === true && state.abort()\n    state.files.value.length > 0 && revokeImgURLs()\n  })\n\n  const publicApi = {}\n\n  for (const key in state) {\n    if (isRef(state[ key ]) === true) {\n      injectProp(publicApi, key, () => state[ key ].value)\n    }\n    else { // method or non-computed prop\n      publicApi[ key ] = state[ key ]\n    }\n  }\n\n  Object.assign(publicApi, {\n    upload,\n    reset,\n    removeUploadedFiles,\n    removeQueuedFiles,\n    removeFile,\n\n    pickFiles,\n    addFiles\n  })\n\n  injectMultipleProps(publicApi, {\n    canAddFiles: () => canAddFiles.value,\n    canUpload: () => canUpload.value,\n    uploadSizeLabel: () => uploadSizeLabel.value,\n    uploadProgressLabel: () => uploadProgressLabel.value\n  })\n\n  // expose public api (methods & computed props)\n  Object.assign(proxy, publicApi)\n\n  return () => {\n    const children = [\n      h('div', { class: colorClass.value }, getHeader()),\n      h('div', { class: 'q-uploader__list scroll' }, getList()),\n      getDndNode('uploader')\n    ]\n\n    state.isBusy.value === true && children.push(\n      h('div', {\n        class: 'q-uploader__overlay absolute-full flex flex-center'\n      }, [ h(QSpinner) ])\n    )\n\n    const data = { ref: rootRef, class: classes.value }\n\n    if (canAddFiles.value === true) {\n      Object.assign(data, { onDragover, onDragleave })\n    }\n\n    return h('div', data, children)\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}